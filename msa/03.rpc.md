# RPC

## RPC란?

> RPC(Remote Procedure call)이란, 별도의 원격 제어를 위한 코딩 없이 다른 주소 공간에서 리모트의 함수나 프로시저를 실행 할 수 있게 해주는 프로세스간 통신입니다. 즉, 위치에 상관없이 RPC를 통해 개발자는 위치에 상관없이 원하는 함수를 사용할 수 있습니다.

RPC란 Remote Procedure Call의 약자로, 말 그대로 **원격에서 Procedure를 호출해주는 미들웨어**를 의미한다.

즉 RPC는 Inter-Process Communication의 일종으로, IPC 중 원격에서의 Procedure 호출 또는 함수를 호출하는데 같은 프로세스의 메소드를 호출하는 것 처럼 사용하도록 돕는것을 의미한다.

> IPC는 **프로세스 사이의 통신**을 가능하게 하는 기술이다.
>
> 공유 메모리를 통해서 자원을 공유하거나, 세마포어를 두거나, MQ, RPC 등이 있다.

RPC는 주로 **분산 컴퓨팅 환경**에서 사용되며, 다음과 같이 동작한다.

![img](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=http%3A%2F%2Fcfile24.uf.tistory.com%2Fimage%2F99F9CD365F709DE10FCC6E)

여기서 Client는 Caller, Server는 Callee 라고도 부른다.

<br>

1. Interface Definition Language로 호출에 대한 인터페이스를 정의한다.

2. IDL에서 정의된 인터페이스는 Client와 Server Stub의 기반이 된다. Stub Compiler가 알아서 코드를 작성해 준다.
   Parameter 객체를 Message로 변환해 준다.

   > Server Stub = Skeleton

3. Client가 다른곳의 함수를 호출한다.

4. Client Stub의 함수의 매개변수들을 변환한다.

5. Client의 RPC Runtime이 다른곳으로 요청(Call Packet)을 보낸다.

   > RPC Runtime이 Client와 Server를 이어줘서 에러, 요청, 응답을 처리하는 역할을 한다.

6. Server의 RPC Runtime이 Call Packet을 받는다.

7. Skeleton이 요청의 파라미터를 변환해 준다.

8. 실제 함수가 호출된다.

9. 함수의 반환값이 Skeleton에 의해 다시 변환된다.

10. Server의 RPC Runtime에 의해 Result Packet이 반환된다.

11. Client의 RPC Runtime이 Packet을 받고, Blocking이 풀리게 된다.

12. Client Stub은 다시 Packet을 변환해 준다.

13. Client에게 결과값이 반환된다.

<br>

Stub은 RPC의 핵심 개념이기 때문에 조금 더 자세히 말하자면, 서버와 클라이언트가 다른 프로세스이기 때문에 반드시 매개변수를 변환해 주어야 한다.

A 서버의 주소값과 B 서버의 주소값이 다르기 때문에 문제가 발생할 수 있기 때문이다.

따라서 Client의 Stub은 **파라미터를 변환(Marshalling)**을 해주고, 서버에서 **반환된 값을 다시 변환**하는 역할을 맡는다.

Server Stub(Skeleton)에서는 **클라이언트의 파라미터를 역변환(Unmarshalling)**하고, 함수의 실행 결과 반환을 담당한다.