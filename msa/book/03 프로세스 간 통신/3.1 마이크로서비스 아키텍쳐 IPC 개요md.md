서비스에 적용 가능한 IPC 기술은 종류가 많다.

- HTTP 기반 Rest 통신
- gRPC
- AMQP
- STOMP

또한 메세지 포맷도 JSON, XML이나 Protocol Buffer와 같이 효율이 좋은 포맷까지 다양하다.

<br>

# 3.1.1 상호 작용 스타일

서비스 API에 맞는 IPC를 선택하기 전, **서비스와 클라이언트 사이의 상호작용 스타일**에 대해 이해하는게 좋다.

그래야지 IPC 기술의 세부 내용에 빠져 헤매는걸 방지할 수 있다.

상호 작용 스타일의 선택은 Application의 가용성에도 영향을 미치며, 테스트 전략 수립에도 좋다.

상호 작용 스타일은 두 가지 기준으로 분류할 수 있다.

<br>

먼저 요청을 처리하는 서비스의 개수이다.

- **일대일: **각 클라이언트의 요청을 한 서비스가 처리
- **일대다: **각 클라이언트의 요청을 여러 서비스가 처리

<br>

그리고 동기인지 비동기인지 여부를 선택하면 된다.

- **동기: **클라이언트는 서비스가 즉시 응답하리라 기대하고 Thread를 Blocking한다.
- **비동기: **클라이언트가 블로킹되지 않는다. 응답은 굳이 즉시 전송될 필요도 없다.

<br>

각각 스타일에 따른 종류는 다음과 같다.

| 서비스 | 일대일                            | 일대다                        |
| ------ | --------------------------------- | ----------------------------- |
| 동기   | Request/Response                  | X                             |
| 비동기 | 비동기 요청/응답<br />단방향 알림 | pub/sub<br />발행/비동기 응답 |

<br>

## 일대일 상호작용

### Request/Response

클라이언트는 서비스에 요청을 하고 응답을 기다린다.

클라이언트는 응답이 제때 도착하리라 기대하고, 대기 중 **블로킹**된다.

결국 **서비스가 강하게 결합**된다.

<br>

### Asynchronous Request/Response

클라이언트는 서비스에 요청을 보내고, 서비스는 **비동기적으로 응답**한다.

클라이언트는 **블로킹하지 않고 서비스는 응답을 오랫동안 하지 않을 수 있다.**

<br>

### One-way Notification

클라이언트는 일방적으로 요청만 하고, 서비스는 응답을 보내지 않는다.

Fire-And-Forget 모델과 비슷하다.

<br>

Synchronous Request/Response는 보통 **IPC 기술에 독립적**인 상호 작용 스타일 이다.

예를 들어, Request/Response Model로 REST 또는 Messaging 통신을 할 수 있다.

이 경우에는 Message Broker로 통신하고 있더라도 **Client는 Blocking**된다.

서비스가 느슨한 결합을 유지하고 있든, 강하게 결합되어 있든 Blocking된다.

> 이 부분은 뒤에서 다시 다룰 에정이다.

<br>

## 일대다 상호 작용

### Publisher/Subscribe

클라이언트는 **메세지를 발행**하고, 여기에 관심이 있는 서비스들이 **메세지를 소비**한다.

관심이 있는 서비스는 있을수도, 없을수도 있다.

<br>

### Publish/Async Response

클라이언트는 **메세지를 발행**하고, **주어진 시간 안에 서비스가 응답하길 기다린다.**

서비스의 응답을 기다린다는 점에서 Pub/Sub 모델과는 다르다.

