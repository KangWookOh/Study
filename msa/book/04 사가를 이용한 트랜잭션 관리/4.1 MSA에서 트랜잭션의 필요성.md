# 4.1.1 분산 트랜잭션의 필요성

기존의 Monolithic Architecture에서는 그냥 `@Transactional` 어노테이션을 붙이면 트랜잭션 처리가 가능했다.

하지만 데이터가 여러 서비스에 걸쳐져 있는 MSA에서는 평소와는 다르게 훨씬 복잡하다.

서비스별로 DB를 따로 가지기 때문에 일관성을 유지할 수 있는 다른 방법을 찾아야 한다.

# 4.1.2 분산 트랜잭션의 문제점

이전에는 분산 트랜잭션으로 서비스부터 DB, Message Broker에 걸쳐 데이터 일관성을 유지했다.

X/Open DTP`(Distributed Transaction Processing)`모델은 분산 트랜잭션 관리의 표준에 가까울만큼 많이 사용되었다.

XA는 2단계 커밋을 이용해서 **한 요청에 필요한 모든 트랜잭션들이 커밋되어야지만 트랜잭션이 커밋되고, 하나라도 실패하면 롤백을 보장**한다.

![Img](../../images/157.jpeg)

XA는 XA와 호환되는 기술끼리 Transaction의 ID가 전파되도록 하는 프로세스 사이의 메커니즘으로 동작한다.

<br>

하지만 이러한 분산 트랜잭션은 NoSQL이나 현대의 Message Broker에서 지원하지 않는다는 문제가 있다.

따라서 **분산 트랜잭션을 사용하게 되면 좋은 기술들을 사용하지 못할 수도 있다.**

또한 **동기 IPC 형태이기 때문에 가용성이 저하**된다는 단점이 있다.

요즘 Architecture들은 **일관성보다 가용성을 우선시**하기 때문에 이러한 단점들은 치명적이다.

<br>

이러한 단점들을 해결하기 위해 비동기적으로 데이터 일관성을 유지하는 메커니즘이 사가 패턴이다.

