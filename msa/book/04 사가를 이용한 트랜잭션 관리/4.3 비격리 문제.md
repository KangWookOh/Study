# Saga에서의 격리성

ACID에서 Isolation이란 **동시에 실행된 트랜잭션에서 쿼리의 동일함을 보장하는 속성**이다.

이로 인해서 개발자는 동시에 실행되는 여러 트랜잭션들이 실행되는 상황 속에서 비지니스 로직을 비교적 쉽게 작성할 수 있다.

<br>

그런데 **Saga에서는 격리성 이라는 속성이 존재하지 않는다.**

따라서 Saga에서의 ACID는 다음과 같다.

- **Atomicity:** Saga는 트랜잭션을 모두 완수하거나, 모두 Undo한다.
- **Consistency:** 서비스 내의 참조 무결성 로컬 DB가, 여러 서비스에 걸친 참조 무결성은 서비스가 처리해 준다.
- **Isolation:** 존재하지 않음
- **Durability:** 로컬DB에 의존한다.

따라서 하나의 Saga가 실행중일 때 다른 Saga가 데이터를 바꿔치기 할수도 있고, 하나의 Saga에서 수정을 하기 전의 데이터를 다른 Saga가 읽을수도 있다.

따라서 일관성이 위협받을 수도 있다.

> 예를 들면 한 Saga에서 Order를 생성중일때, Order는 승인 대기중인 상태로 Order서비스의 LocalDB에 존재하게 된다.
>
> 이 때 다른 Saga가 Order 목록을 조회하게 되면 승인 대기중인 Order도 함께 보여지게 된다.
>
> 하지만 이때 Order 생성 Saga가 RollBack된다면 일관성이 위협받게 된다.

비격리는 절대 용납되지 않는 규칙이 아니다.

완전한 비격리를 구현하려 하면 성능이 많이 떨어지게 되서 어느정도 성능과 타협해서 격리 수준을 정하는게 일반적이다.

