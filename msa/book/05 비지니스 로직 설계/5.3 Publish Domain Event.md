# 5.3.1 변경 이벤트를 발행하는 이유

다른 서비스나 Component들이 Domain 객체의 변화를 인지할 필요가 있는 경우가 있기 때문에 사용해야 한다.

다음과 같은 상황에서 사용될 수 있다.

- **Choreography 기반의 Saga를 사용할 때**
- **Replica를 둔 서비스를 이용할 때**
- **Message Broker나 WebHook을 통해 다음 비지니스 로직을 수행할 때**
- **WebSocket 메세지를 전달할 때**
- **Text DB(Elastic Search 등)를 수정할 때**
- **사용자에게 도메인 이벤트의 변경을 알릴 때**
- **Application이 제대로 동작하는지 분석할 때**
- **사용자의 행동을 모니터링 할 때**

또한 Aggregate의 상태 변화를 관리하는 역할도 한다.

# 5.3.2 도메인 이벤트란

**Domain Event란 과거형 동사 클래스`(OrderCreated, OrderDeleted 등)`**로, OrderId와 같은 **Property**들이 있다.

Domain Event는 주로 EventID, Timestamp, PK값과 같은 Metadata를 포함시켜 준다.

<br>

MetaData는 다음과 같은 방식들로 구성될 수 있다.

- Domain Event 클래스의 객체 필드
- 부모 클래스에 정의된 Event 객체의 일부
- Domain Event를 Wrapping하는 클래스

<br>

OrderCreatedEvent 라는 Event가 있다고 가정하면 다음과 같은 클래스가 나온다.

``` java
interface DomainEvent {}		// 자신을 구현할 클래스 Domain Event	라는것을 알리기 위한 Marker Interface

interface OrderDomainEvent extends DomainEvent {}		// Order의 Event라는 것을 알리기 위한 Marker Interface

class OrderCreated implements OrderDomainEvent {}

class DomainEventEnvelope<T extends DomainEvent> {
	private String aggregateType;		// Event의 Metadata
	private Object aggregateId;
	private T event;
	...
}
```

DomainEventEnvelope는 **Event를 감싸는 Wrapper 클래스**로, **Metadata와 Event 객체**를 담고있다.

