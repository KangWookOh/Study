# 챕터6 다양한 연관관계 매핑

### 연관관계 소개

##### 연관관계에서 조심할 것

- 다중성

  어떤 관계를 갖는지에 대해 고민해야 한다.

  > 다대일, 일대일과 같은 관계를 정의한다.

- 단방향, 양방향

  단방향으로 매핑할지, 양방향으로 매핑할 지에 대해 고민해야 한다.

  > 웬만하면 양방향이 추천된다.

- 연관관계의 주인

  연관관계의 **master와 slave를 명확하게** 생각해 두어야 한다.

  > 외래 키를 어느 테이블에서 가지고 있는지 고민해야 한다.

##### 다중성

연관관계에는 일대다/다대일만 있는게 아니다.

- 다대일(`@ManyToOne`)
- 일대다(`@OneToMany`)
- 일대일(`@OneToOne`)
- 다대다(`@ManyToMany`)

> 판단이 어려울 때엔 반대에서 생각하면 된다.

##### 연관관계의 주인

JPA는 두 객체 연관관계 중 하나를 정해서 외래 키를 관리한다.

이 중 외래 키를 관리하는 객체를 **연관 관계의 주인** 이라고 한다.

> master - slave 구조를 가지게 된다

### 다대일

> 다대일 관계에서 반대는 항상 일대다 관계이고, 반대 방향은 항상 다대일 이다.

객체의 양방향 관계에서 연관관계의 주인은 항상 다쪽이다.

즉, **1:N 관계에서 N쪽 객체가 키를 관리**한다는 의미이다.

#### 다대일 단방향

다대일 관계는 아래와 같은 형태를 말한다.

![onetomany_one](.\images\onetomany_one.png)

다대일 단방향 관계란 외래 키를 관리하는 객체 즉 **Member쪽에서 team 객체를 참조하는 형태**를 가진다.

> 그렇기 때문에 Team 객체에선 매핑되지 않는다.
>
> 즉, 변화가 없다.

```java
@Entity
public class Member {
    @Id
    @GeneratedValue
    @Column
    private Long id;
    
    private String username;
    
    @ManyToOne
    @JoinColumn(name="team_id")	// 반대쪽 테이블의 PK 필드 이름
    private Team team;
}
```

#### 다대일 양방향

단방향 매핑은 